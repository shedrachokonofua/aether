---
- name: Configure Router
  hosts: router
  gather_facts: false
  roles:
    - common
    - vm_baseline
  vars:
    ansible_persistent_connect_timeout: 0
  tasks:
    - name: Remove default vyos user
      vyos.vyos.vyos_config:
        lines:
          - delete system login user vyos
        save: true

    - name: Disable IPv6
      vyos.vyos.vyos_config:
        lines:
          - set system ipv6 disable
          - set interfaces ethernet eth0 ipv6 address no-default-link-local
          - set interfaces ethernet eth1 ipv6 address no-default-link-local
        save: true

    - name: Configure WAN
      vyos.vyos.vyos_config:
        lines:
          - set interfaces pppoe pppoe0 authentication username {{ secrets.pppoe_username }}
          - set interfaces pppoe pppoe0 authentication password {{ secrets.pppoe_password }}
          - set interfaces pppoe pppoe0 source-interface eth0
          - set interfaces pppoe pppoe0 ip adjust-mss 1452
        save: true

    - name: Configure NAT
      vyos.vyos.vyos_config:
        lines:
          # WAN
          - set nat source rule 100 outbound-interface name pppoe0
          - set nat source rule 100 source address 10.0.0.0/16
          - set nat source rule 100 translation address masquerade
          # VLAN 2 to Gigahub network
          - set nat source rule 101 description "VLAN 2 to Gigahub network"
          - set nat source rule 101 source address 10.0.2.0/24
          - set nat source rule 101 outbound-interface name eth0
          - set nat source rule 101 destination address 192.168.2.0/24
          - set nat source rule 101 translation address masquerade
          # VLAN 4 to Gigahub network
          - set nat source rule 102 description "VLAN 4 to Gigahub network"
          - set nat source rule 102 source address 10.0.4.0/24
          - set nat source rule 102 outbound-interface name eth0
          - set nat source rule 102 destination address 192.168.2.0/24
          - set nat source rule 102 translation address masquerade
        save: true

    - name: Configure DNS Forwarding
      vyos.vyos.vyos_config:
        lines:
          - set service dns forwarding listen-address 10.0.0.1
          - set service dns forwarding listen-address 10.0.2.1
          - set service dns forwarding listen-address 10.0.3.1
          - set service dns forwarding listen-address 10.0.4.1
          - set service dns forwarding listen-address 10.0.5.1
          - set service dns forwarding listen-address 10.0.6.1
          - set service dns forwarding listen-address 10.0.7.1
          - set service dns forwarding allow-from 10.0.0.0/16
          - set service dns forwarding cache-size 50000
          - set service dns forwarding negative-ttl 0
          - set service dns forwarding name-server {{ vm.home_gateway_stack.ip }}
          - set service dns forwarding name-server 8.8.8.8
        save: true

    - name: Configure VLAN interfaces
      vyos.vyos.vyos_config:
        lines:
          - set interfaces ethernet eth1 vif 2 description "Infrastructure"
          - set interfaces ethernet eth1 vif 2 address 10.0.2.1/24
          - set interfaces ethernet eth1 vif 3 description "Services"
          - set interfaces ethernet eth1 vif 3 address 10.0.3.1/24
          - set interfaces ethernet eth1 vif 4 description "Personal"
          - set interfaces ethernet eth1 vif 4 address 10.0.4.1/24
          - set interfaces ethernet eth1 vif 5 description "Media"
          - set interfaces ethernet eth1 vif 5 address 10.0.5.1/24
          - set interfaces ethernet eth1 vif 6 description "IoT"
          - set interfaces ethernet eth1 vif 6 address 10.0.6.1/24
          - set interfaces ethernet eth1 vif 7 description "Guest"
          - set interfaces ethernet eth1 vif 7 address 10.0.7.1/24
        save: true

    - name: Configure SSH
      vyos.vyos.vyos_config:
        lines:
          - set service ssh disable-password-authentication
          - set service ssh port 22
          - set service ssh listen-address 10.0.2.1
          - set service ssh listen-address 10.0.4.1
          - set service ssh listen-address 192.168.2.231
        save: true

    - name: Configure DHCP Server
      vyos.vyos.vyos_config:
        lines:
          # Infrastructure
          - set service dhcp-server shared-network-name INFRA authoritative
          - set service dhcp-server shared-network-name INFRA subnet 10.0.2.0/24 subnet-id 2
          - set service dhcp-server shared-network-name INFRA subnet 10.0.2.0/24 option default-router "10.0.2.1"
          - set service dhcp-server shared-network-name INFRA subnet 10.0.2.0/24 option name-server "10.0.2.1"
          - set service dhcp-server shared-network-name INFRA subnet 10.0.2.0/24 option domain-name "home.shdr.ch"
          - set service dhcp-server shared-network-name INFRA subnet 10.0.2.0/24 lease "86400"
          - set service dhcp-server shared-network-name INFRA subnet 10.0.2.0/24 range 0 start "10.0.2.240"
          - set service dhcp-server shared-network-name INFRA subnet 10.0.2.0/24 range 0 stop "10.0.2.254"

          # Services
          - set service dhcp-server shared-network-name SERVICES authoritative
          - set service dhcp-server shared-network-name SERVICES subnet 10.0.3.0/24 subnet-id 3
          - set service dhcp-server shared-network-name SERVICES subnet 10.0.3.0/24 option default-router "10.0.3.1"
          - set service dhcp-server shared-network-name SERVICES subnet 10.0.3.0/24 option name-server "10.0.3.1"
          - set service dhcp-server shared-network-name SERVICES subnet 10.0.3.0/24 option domain-name "home.shdr.ch"
          - set service dhcp-server shared-network-name SERVICES subnet 10.0.3.0/24 lease "86400"
          - set service dhcp-server shared-network-name SERVICES subnet 10.0.3.0/24 range 0 start "10.0.3.240"
          - set service dhcp-server shared-network-name SERVICES subnet 10.0.3.0/24 range 0 stop "10.0.3.254"

          # Personal
          - set service dhcp-server shared-network-name PERSONAL authoritative
          - set service dhcp-server shared-network-name PERSONAL subnet 10.0.4.0/24 subnet-id 4
          - set service dhcp-server shared-network-name PERSONAL subnet 10.0.4.0/24 option default-router "10.0.4.1"
          - set service dhcp-server shared-network-name PERSONAL subnet 10.0.4.0/24 option name-server "10.0.4.1"
          - set service dhcp-server shared-network-name PERSONAL subnet 10.0.4.0/24 option domain-name "home.shdr.ch"
          - set service dhcp-server shared-network-name PERSONAL subnet 10.0.4.0/24 lease "86400"
          - set service dhcp-server shared-network-name PERSONAL subnet 10.0.4.0/24 range 0 start "10.0.4.2"
          - set service dhcp-server shared-network-name PERSONAL subnet 10.0.4.0/24 range 0 stop "10.0.4.254"
          # Media
          - set service dhcp-server shared-network-name MEDIA authoritative
          - set service dhcp-server shared-network-name MEDIA subnet 10.0.5.0/24 subnet-id 5
          - set service dhcp-server shared-network-name MEDIA subnet 10.0.5.0/24 option default-router "10.0.5.1"
          - set service dhcp-server shared-network-name MEDIA subnet 10.0.5.0/24 option name-server "10.0.5.1"
          - set service dhcp-server shared-network-name MEDIA subnet 10.0.5.0/24 option domain-name "home.shdr.ch"
          - set service dhcp-server shared-network-name MEDIA subnet 10.0.5.0/24 lease "86400"
          - set service dhcp-server shared-network-name MEDIA subnet 10.0.5.0/24 range 0 start "10.0.5.2"
          - set service dhcp-server shared-network-name MEDIA subnet 10.0.5.0/24 range 0 stop "10.0.5.254"
          # IoT
          - set service dhcp-server shared-network-name IOT authoritative
          - set service dhcp-server shared-network-name IOT subnet 10.0.6.0/24 subnet-id 6
          - set service dhcp-server shared-network-name IOT subnet 10.0.6.0/24 option default-router "10.0.6.1"
          - set service dhcp-server shared-network-name IOT subnet 10.0.6.0/24 option name-server "10.0.6.1"
          - set service dhcp-server shared-network-name IOT subnet 10.0.6.0/24 option domain-name "home.shdr.ch"
          - set service dhcp-server shared-network-name IOT subnet 10.0.6.0/24 lease "86400"
          - set service dhcp-server shared-network-name IOT subnet 10.0.6.0/24 range 0 start "10.0.6.2"
          - set service dhcp-server shared-network-name IOT subnet 10.0.6.0/24 range 0 stop "10.0.6.254"
          # Guest
          - set service dhcp-server shared-network-name GUEST authoritative
          - set service dhcp-server shared-network-name GUEST subnet 10.0.7.0/24 subnet-id 7
          - set service dhcp-server shared-network-name GUEST subnet 10.0.7.0/24 option default-router "10.0.7.1"
          - set service dhcp-server shared-network-name GUEST subnet 10.0.7.0/24 option name-server "10.0.7.1"
          - set service dhcp-server shared-network-name GUEST subnet 10.0.7.0/24 option domain-name "home.shdr.ch"
          - set service dhcp-server shared-network-name GUEST subnet 10.0.7.0/24 lease "86400"
          - set service dhcp-server shared-network-name GUEST subnet 10.0.7.0/24 range 0 start "10.0.7.2"
          - set service dhcp-server shared-network-name GUEST subnet 10.0.7.0/24 range 0 stop "10.0.7.254"
        save: true

    - name: Configure mDNS repeater
      vyos.vyos.vyos_config:
        lines:
          - set service mdns repeater interface eth1.3
          - set service mdns repeater interface eth1.4
          - set service mdns repeater interface eth1.5
          - set service mdns repeater interface eth1.6
        save: true

    - name: Configure NetFlow
      vyos.vyos.vyos_config:
        lines:
          - set system flow-accounting interface eth0
          - set system flow-accounting interface eth1.2
          - set system flow-accounting interface eth1.3
          - set system flow-accounting interface eth1.4
          - set system flow-accounting interface eth1.5
          - set system flow-accounting interface eth1.6
          - set system flow-accounting interface eth1.7
          - set system flow-accounting netflow engine-id 100
          - set system flow-accounting netflow server {{ vm.monitoring_stack.ip }} port 2055
          - set system flow-accounting netflow version 9
        save: true

    - name: Configure firewall
      vyos.vyos.vyos_config:
        save: true
        lines:
          # Define WAN zone
          - set firewall zone WAN description 'Internet facing interface'
          - set firewall zone WAN member interface pppoe0
          - set firewall zone WAN default-action drop

          # Define MGMT zone for Gigahub network
          - set firewall zone MGMT description 'Gigahub management network'
          - set firewall zone MGMT member interface eth0
          - set firewall zone MGMT default-action drop

          # Define TRUSTED zone - full access networks
          - set firewall zone TRUSTED description 'Trusted internal networks'
          - set firewall zone TRUSTED member interface eth1.2
          - set firewall zone TRUSTED member interface eth1.4
          - set firewall zone TRUSTED default-action drop

          # Define SERVICES zone - application services
          - set firewall zone SERVICES description 'Application services network'
          - set firewall zone SERVICES member interface eth1.3
          - set firewall zone SERVICES default-action drop

          # Define MEDIA zone - limited access
          - set firewall zone MEDIA description 'Media devices network'
          - set firewall zone MEDIA member interface eth1.5
          - set firewall zone MEDIA default-action drop

          # Define UNTRUSTED zone - minimal access
          - set firewall zone UNTRUSTED description 'IoT and Guest networks'
          - set firewall zone UNTRUSTED member interface eth1.6
          - set firewall zone UNTRUSTED member interface eth1.7
          - set firewall zone UNTRUSTED default-action drop

          # Define LOCAL zone for router itself
          - set firewall zone LOCAL local-zone
          - set firewall zone LOCAL description 'Router local zone'
          - set firewall zone LOCAL default-action drop

          # Configure outbound internet access for all zones
          - set firewall ipv4 name ZONES-to-WAN default-action accept
          - set firewall ipv4 name ZONES-to-WAN description 'Allow all zones to access internet'

          # Configure inbound WAN protection
          - set firewall ipv4 name WAN-to-ZONES default-action drop
          - set firewall ipv4 name WAN-to-ZONES rule 10 action accept
          - set firewall ipv4 name WAN-to-ZONES rule 10 state established
          - set firewall ipv4 name WAN-to-ZONES rule 10 state related

          # Create TRUSTED to LOCAL firewall rules
          - set firewall ipv4 name TRUSTED-to-LOCAL default-action accept
          - set firewall ipv4 name TRUSTED-to-LOCAL description 'Full access from trusted networks'

          # Create MEDIA to LOCAL firewall rules
          - set firewall ipv4 name MEDIA-to-LOCAL default-action drop
          - set firewall ipv4 name MEDIA-to-LOCAL description 'Limited access from media network'
          - set firewall ipv4 name MEDIA-to-LOCAL rule 10 action accept
          - set firewall ipv4 name MEDIA-to-LOCAL rule 10 state established
          - set firewall ipv4 name MEDIA-to-LOCAL rule 10 state related
          - set firewall ipv4 name MEDIA-to-LOCAL rule 20 action accept
          - set firewall ipv4 name MEDIA-to-LOCAL rule 20 protocol tcp_udp
          - set firewall ipv4 name MEDIA-to-LOCAL rule 20 destination port 53,67-68,5353
          - set firewall ipv4 name MEDIA-to-LOCAL rule 20 description 'Allow DNS, DHCP, mDNS'
          - set firewall ipv4 name MEDIA-to-LOCAL rule 30 action accept
          - set firewall ipv4 name MEDIA-to-LOCAL rule 30 protocol icmp
          - set firewall ipv4 name MEDIA-to-LOCAL rule 30 description 'Allow ping'

          # Create UNTRUSTED to LOCAL firewall rules
          - set firewall ipv4 name UNTRUSTED-to-LOCAL default-action drop
          - set firewall ipv4 name UNTRUSTED-to-LOCAL description 'Minimal access from untrusted networks'
          - set firewall ipv4 name UNTRUSTED-to-LOCAL rule 10 action accept
          - set firewall ipv4 name UNTRUSTED-to-LOCAL rule 10 state established
          - set firewall ipv4 name UNTRUSTED-to-LOCAL rule 10 state related
          - set firewall ipv4 name UNTRUSTED-to-LOCAL rule 20 action accept
          - set firewall ipv4 name UNTRUSTED-to-LOCAL rule 20 protocol tcp_udp
          - set firewall ipv4 name UNTRUSTED-to-LOCAL rule 20 destination port 53,67-68,5353
          - set firewall ipv4 name UNTRUSTED-to-LOCAL rule 20 description 'Allow DNS, DHCP, mDNS'

          # Create SERVICES to LOCAL firewall rules
          - set firewall ipv4 name SERVICES-to-LOCAL default-action drop
          - set firewall ipv4 name SERVICES-to-LOCAL description 'Limited access from services network'
          - set firewall ipv4 name SERVICES-to-LOCAL rule 10 action accept
          - set firewall ipv4 name SERVICES-to-LOCAL rule 10 state established
          - set firewall ipv4 name SERVICES-to-LOCAL rule 10 state related
          - set firewall ipv4 name SERVICES-to-LOCAL rule 20 action accept
          - set firewall ipv4 name SERVICES-to-LOCAL rule 20 protocol tcp_udp
          - set firewall ipv4 name SERVICES-to-LOCAL rule 20 destination port 53,67-68
          - set firewall ipv4 name SERVICES-to-LOCAL rule 20 description 'Allow DNS and DHCP only'

          # Create MGMT to LOCAL firewall rules
          - set firewall ipv4 name MGMT-to-LOCAL default-action drop
          - set firewall ipv4 name MGMT-to-LOCAL rule 10 action accept
          - set firewall ipv4 name MGMT-to-LOCAL rule 10 state established
          - set firewall ipv4 name MGMT-to-LOCAL rule 10 state related
          - set firewall ipv4 name MGMT-to-LOCAL rule 20 action accept
          - set firewall ipv4 name MGMT-to-LOCAL rule 20 protocol tcp
          - set firewall ipv4 name MGMT-to-LOCAL rule 20 destination port 22
          - set firewall ipv4 name MGMT-to-LOCAL rule 20 source address 192.168.2.0/24
          - set firewall ipv4 name MGMT-to-LOCAL rule 20 description 'Allow SSH from Gigahub network'

          # Create WAN to LOCAL firewall rules
          - set firewall ipv4 name WAN-to-LOCAL default-action drop
          - set firewall ipv4 name WAN-to-LOCAL rule 10 action accept
          - set firewall ipv4 name WAN-to-LOCAL rule 10 state established
          - set firewall ipv4 name WAN-to-LOCAL rule 10 state related

          # Configure router outbound internet access
          - set firewall ipv4 name LOCAL-to-WAN default-action accept
          - set firewall ipv4 name LOCAL-to-WAN description 'Allow router to access internet'

          # Configure router access to internal zones
          - set firewall ipv4 name LOCAL-to-ZONES default-action accept
          - set firewall ipv4 name LOCAL-to-ZONES description 'Allow router to access all zones'

          # Configure trusted zones full access
          - set firewall ipv4 name TRUSTED-to-MGMT default-action accept
          - set firewall ipv4 name TRUSTED-to-MEDIA default-action accept
          - set firewall ipv4 name TRUSTED-to-UNTRUSTED default-action accept
          - set firewall ipv4 name TRUSTED-to-SERVICES default-action accept
          - set firewall ipv4 name MGMT-to-TRUSTED default-action accept
          - set firewall ipv4 name MGMT-to-MEDIA default-action accept
          - set firewall ipv4 name MGMT-to-UNTRUSTED default-action accept
          - set firewall ipv4 name MGMT-to-SERVICES default-action accept
          - set firewall ipv4 name SERVICES-to-MGMT default-action drop
          - set firewall ipv4 name SERVICES-to-MGMT rule 10 action accept
          - set firewall ipv4 name SERVICES-to-MGMT rule 10 state established
          - set firewall ipv4 name SERVICES-to-MGMT rule 10 state related

          # Configure media zone restrictions
          - set firewall ipv4 name MEDIA-to-TRUSTED default-action drop
          - set firewall ipv4 name MEDIA-to-TRUSTED rule 10 action accept
          - set firewall ipv4 name MEDIA-to-TRUSTED rule 10 state established
          - set firewall ipv4 name MEDIA-to-TRUSTED rule 10 state related
          - set firewall ipv4 name MEDIA-to-MGMT default-action drop
          - set firewall ipv4 name MEDIA-to-MGMT rule 10 action accept
          - set firewall ipv4 name MEDIA-to-MGMT rule 10 state established
          - set firewall ipv4 name MEDIA-to-MGMT rule 10 state related
          - set firewall ipv4 name MEDIA-to-UNTRUSTED default-action drop
          - set firewall ipv4 name UNTRUSTED-to-MEDIA default-action drop

          # Configure services zone policies
          - set firewall ipv4 name SERVICES-to-TRUSTED default-action drop
          - set firewall ipv4 name SERVICES-to-TRUSTED rule 10 action accept
          - set firewall ipv4 name SERVICES-to-TRUSTED rule 10 state established
          - set firewall ipv4 name SERVICES-to-TRUSTED rule 10 state related
          - set firewall ipv4 name SERVICES-to-TRUSTED rule 20 action accept
          - set firewall ipv4 name SERVICES-to-TRUSTED rule 20 protocol tcp_udp
          - set firewall ipv4 name SERVICES-to-TRUSTED rule 20 destination port 53,111,443,2049,4317,4318
          - set firewall ipv4 name SERVICES-to-TRUSTED rule 20 destination address 10.0.2.0/24
          - set firewall ipv4 name SERVICES-to-TRUSTED rule 20 description 'Allow DNS, NFS, monitoring to Infrastructure (VLAN 2)'
          - set firewall ipv4 name SERVICES-to-MEDIA default-action accept
          - set firewall ipv4 name SERVICES-to-UNTRUSTED default-action drop
          - set firewall ipv4 name SERVICES-to-UNTRUSTED rule 10 action accept
          - set firewall ipv4 name SERVICES-to-UNTRUSTED rule 10 state established
          - set firewall ipv4 name SERVICES-to-UNTRUSTED rule 10 state related
          - set firewall ipv4 name SERVICES-to-UNTRUSTED rule 20 action accept
          - set firewall ipv4 name SERVICES-to-UNTRUSTED rule 20 destination address 10.0.6.0/24
          - set firewall ipv4 name SERVICES-to-UNTRUSTED rule 20 description 'Allow access to IoT (VLAN 6) only'
          - set firewall ipv4 name MEDIA-to-SERVICES default-action accept

          # Configure untrusted zone isolation
          - set firewall ipv4 name UNTRUSTED-to-TRUSTED default-action drop
          - set firewall ipv4 name UNTRUSTED-to-TRUSTED rule 10 action accept
          - set firewall ipv4 name UNTRUSTED-to-TRUSTED rule 10 state established
          - set firewall ipv4 name UNTRUSTED-to-TRUSTED rule 10 state related
          - set firewall ipv4 name UNTRUSTED-to-MGMT default-action drop
          - set firewall ipv4 name UNTRUSTED-to-MGMT rule 10 action accept
          - set firewall ipv4 name UNTRUSTED-to-MGMT rule 10 state established
          - set firewall ipv4 name UNTRUSTED-to-MGMT rule 10 state related
          - set firewall ipv4 name UNTRUSTED-to-SERVICES default-action drop
          - set firewall ipv4 name UNTRUSTED-to-SERVICES rule 10 action accept
          - set firewall ipv4 name UNTRUSTED-to-SERVICES rule 10 state established
          - set firewall ipv4 name UNTRUSTED-to-SERVICES rule 10 state related

          # Apply WAN zone firewall policies
          - set firewall zone WAN from TRUSTED firewall name ZONES-to-WAN
          - set firewall zone WAN from SERVICES firewall name ZONES-to-WAN
          - set firewall zone WAN from MEDIA firewall name ZONES-to-WAN
          - set firewall zone WAN from UNTRUSTED firewall name ZONES-to-WAN
          - set firewall zone WAN from LOCAL firewall name LOCAL-to-WAN
          - set firewall zone TRUSTED from WAN firewall name WAN-to-ZONES
          - set firewall zone SERVICES from WAN firewall name WAN-to-ZONES
          - set firewall zone MEDIA from WAN firewall name WAN-to-ZONES
          - set firewall zone UNTRUSTED from WAN firewall name WAN-to-ZONES
          - set firewall zone LOCAL from WAN firewall name WAN-to-LOCAL

          # Apply LOCAL zone firewall policies
          - set firewall zone LOCAL from TRUSTED firewall name TRUSTED-to-LOCAL
          - set firewall zone LOCAL from SERVICES firewall name SERVICES-to-LOCAL
          - set firewall zone LOCAL from MEDIA firewall name MEDIA-to-LOCAL
          - set firewall zone LOCAL from UNTRUSTED firewall name UNTRUSTED-to-LOCAL
          - set firewall zone LOCAL from MGMT firewall name MGMT-to-LOCAL
          - set firewall zone TRUSTED from LOCAL firewall name LOCAL-to-ZONES
          - set firewall zone SERVICES from LOCAL firewall name LOCAL-to-ZONES
          - set firewall zone MEDIA from LOCAL firewall name LOCAL-to-ZONES
          - set firewall zone UNTRUSTED from LOCAL firewall name LOCAL-to-ZONES
          - set firewall zone MGMT from LOCAL firewall name LOCAL-to-ZONES

          # Apply inter-zone firewall policies
          - set firewall zone MGMT from TRUSTED firewall name TRUSTED-to-MGMT
          - set firewall zone MEDIA from TRUSTED firewall name TRUSTED-to-MEDIA
          - set firewall zone UNTRUSTED from TRUSTED firewall name TRUSTED-to-UNTRUSTED
          - set firewall zone SERVICES from TRUSTED firewall name TRUSTED-to-SERVICES
          - set firewall zone TRUSTED from MGMT firewall name MGMT-to-TRUSTED
          - set firewall zone MEDIA from MGMT firewall name MGMT-to-MEDIA
          - set firewall zone UNTRUSTED from MGMT firewall name MGMT-to-UNTRUSTED
          - set firewall zone SERVICES from MGMT firewall name MGMT-to-SERVICES
          - set firewall zone MGMT from SERVICES firewall name SERVICES-to-MGMT
          - set firewall zone TRUSTED from SERVICES firewall name SERVICES-to-TRUSTED
          - set firewall zone MEDIA from SERVICES firewall name SERVICES-to-MEDIA
          - set firewall zone UNTRUSTED from SERVICES firewall name SERVICES-to-UNTRUSTED
          - set firewall zone SERVICES from MEDIA firewall name MEDIA-to-SERVICES
          - set firewall zone TRUSTED from MEDIA firewall name MEDIA-to-TRUSTED
          - set firewall zone MGMT from MEDIA firewall name MEDIA-to-MGMT
          - set firewall zone UNTRUSTED from MEDIA firewall name MEDIA-to-UNTRUSTED
          - set firewall zone MEDIA from UNTRUSTED firewall name UNTRUSTED-to-MEDIA
          - set firewall zone TRUSTED from UNTRUSTED firewall name UNTRUSTED-to-TRUSTED
          - set firewall zone MGMT from UNTRUSTED firewall name UNTRUSTED-to-MGMT
          - set firewall zone SERVICES from UNTRUSTED firewall name UNTRUSTED-to-SERVICES
